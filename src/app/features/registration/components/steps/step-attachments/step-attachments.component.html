<div class="wrapper">

  <img src="assets/logo.png" class="header-img" alt="Company Logo">

  <div class="title"><span>Supporting</span> <br>Documents</div>
  <div class="subtitle">Upload identification or supporting documents (Optional)</div>

  <!-- FILE CARDS -->
  @if (attachmentUploadEnabled && documentTypes.length > 0) {
    <div class="files-section">
      @for (doc of documentTypes; track doc.VisitorAttachSeqId) {
        <div class="file-card" [attr.data-id]="doc.VisitorAttachSeqId">
          <div class="file-top">
            <div>
              <div class="file-name">
                {{ doc.Caption }}
                @if (doc.Mandatory) {
                  <span class="mandatory">*</span>
                }
              </div>
              @if (!attachments[doc.VisitorAttachSeqId].file) {
                <div class="file-sub">Max size: {{ maxSize / 1000000 }}MB (.pdf, images)</div>
              } @else {
                <div class="file-sub success">
                  ({{ (attachments[doc.VisitorAttachSeqId].file?.size || 0) / 1024 / 1024 | number: '1.1-1' }}MB) 
                  <span class="success-text">Success</span>
                </div>
              }
            </div>
            <label class="upload-btn">
              @if (!attachments[doc.VisitorAttachSeqId].file) {
                <span>üìÑ</span>
                <input 
                  type="file" 
                  hidden 
                  [accept]="acceptedTypes"
                  (change)="onFileSelect($event, doc.VisitorAttachSeqId)">
              } @else {
                <button 
                  type="button"
                  class="delete-btn"
                  (click)="removeFile(doc.VisitorAttachSeqId)"
                  title="Delete file">
                  üóë
                </button>
              }
            </label>
          </div>
          @if (attachments[doc.VisitorAttachSeqId].file) {
            <div class="progress">
              <div class="bar" [style.width.%]="100"></div>
            </div>
          }
        </div>
      }
    </div>
  }

  <!-- Items Declaration Section -->
  @if (materialDeclareEnabled) {
    <div class="declaration-section">
      <div class="declaration-header">
        <h3>{{ 'Item Declaration' | translate }}</h3>
        <p class="subtitle">Items you wish to declare (Optional)</p>
      </div>

      <!-- Nothing to Declare -->
      <div class="checkbox-group">
        <input 
          type="checkbox" 
          id="nothingToDeclare" 
          [(ngModel)]="nothingToDeclare"
          (change)="onNothingToDeclareChange()">
        <label for="nothingToDeclare">{{ 'i_have_nothing_to_declare' | translate }}</label>
      </div>

      <!-- Item Form (show when not "nothing to declare") -->
      @if (!nothingToDeclare) {
        <div class="items-form">
          <div class="form-row">
            <input 
              type="text" 
              placeholder="{{ 'enter_item_description' | translate }}"
              [(ngModel)]="newItem.description"
              class="form-input">
          </div>
          <div class="form-row">
            <input 
              type="text" 
              placeholder="{{ 'enter_serial_number' | translate }}"
              [(ngModel)]="newItem.serialNumber"
              class="form-input">
          </div>
          <div class="form-row">
            <select [(ngModel)]="newItem.direction" class="form-input">
              <option value="">{{ 'select_direction' | translate }}</option>
              @for (dir of directionOptions; track dir.value) {
                <option [value]="dir.value">{{ dir.label }}</option>
              }
            </select>
          </div>
          <button 
            class="btn add-btn" 
            (click)="addItem()"
            [disabled]="!newItem.description.trim()">
            + Add Item
          </button>
        </div>

        <!-- Declared Items List -->
        @if (declaredItems && declaredItems.length > 0) {
          <div class="items-list">
            @for (item of declaredItems; track $index) {
              <div class="item-card">
                <div class="item-info">
                  <div class="item-description">{{ item.description }}</div>
                  <div class="item-meta">
                    {{ item.serialNumber || '-' }} ‚Ä¢ {{ getDirectionLabel(item.direction) }}
                  </div>
                </div>
                <button 
                  class="remove-btn" 
                  (click)="removeItem($index)"
                  title="Remove">
                  ‚úï
                </button>
              </div>
            }
          </div>
        }
      }
    </div>
  }

  <div class="bottom">
    <div class="row">
      <button class="btn white" (click)="goBack()">‚Üê Back</button>
      <button class="btn white" (click)="skipStep()">Skip ‚Üí</button>
    </div>
    <button class="btn continue" (click)="proceedToNext()">Continue ‚Üí</button>
  </div>

</div>